
CREATE OR REPLACE VIEW RELATORIO_VENDAS_MENSAIS AS 
  SELECT
    TO_CHAR(V.DATA_VENDA, 'MM/YYYY') AS "PERÍODO",
    COUNT (*)                        AS "TOTAL DE VENDAS",
    SUM(V.VALOR_TOTAL)               AS "VALOR TOTAL",
    SUM(C.PONTOS_FIDELIDADE)         AS "PONTOS ACUMULADOS",
    TRUNC(AVG(C.PONTOS_FIDELIDADE))  AS "MÉDIA DE PONTOS"
        FROM VENDAS V
         INNER JOIN CLIENTES C ON V.ID_CLIENTE = C.ID_CLIENTE
 GROUP BY TO_CHAR(V.DATA_VENDA, 'MM/YYYY');

