CREATE OR REPLACE VIEW RELATORIO_CLIENTES
AS SELECT 
       C.ID_CLIENTE        AS "ID_CLIENTE",
       C.NOME              AS "CLIENTE",
       C.PONTOS_FIDELIDADE AS "PONTOS",
       CASE 
        WHEN C.PONTOS_FIDELIDADE >= 500 THEN 'Platina'
        WHEN C.PONTOS_FIDELIDADE >= 300 THEN 'Ouro'
        WHEN C.PONTOS_FIDELIDADE >= 200 THEN 'Prata'
        ELSE 'Bronze' END CATEGORIA
 FROM VENDAS V
 INNER JOIN CLIENTES C ON C.ID_CLIENTE = V.ID_CLIENTE
 GROUP BY C.ID_CLIENTE, C.NOME, C.PONTOS_FIDELIDADE
 ORDER BY C.PONTOS_FIDELIDADE DESC;
