CREATE OR REPLACE FUNCTION CALCULAR_PONTOS_FIDELIDADE (
    ID_CLIENTE_VENDA NUMBER,
    VALOR_COMPRA NUMBER
) 

RETURN NUMBER
IS PONTOS NUMBER;

BEGIN

  PONTOS := TRUNC(VALOR_COMPRA);
    
  -- Seleciona quantidade de ponto atual
  SELECT PONTOS_FIDELIDADE INTO PONTOS_ATUAL
    FROM CLIENTES
  WHERE ID_CLIENTE = ID_CLIENTE_VENDA;
  
  // Atualiza os pontos na tabela
  UPDATE CLIENTES 
   SET PONTOS_FIDELIDADE = PONTOS_ATUAL + PONTOS
   WHERE ID_CLIENTE = ID_CLIENTE_VENDA;

  RETURN PONTOS;
END;